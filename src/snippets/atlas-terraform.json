{
  "MongoDB Atlas Terraform Template": {
    "prefix": "atlas",
<<<<<<< HEAD
    "body": [
      "#",
      "# Example Terraform Config to create a",
      "# MongoDB Atlas Shared Tier Project, Cluster,",
      "# Database User and Project IP Whitelist Entry",
      "#",
      "# First step is to create a MongoDB Atlas account",
      "# https://docs.atlas.mongodb.com/tutorial/create-atlas-account/",
      "#",
      "# Then create an organization and programmatic API key",
      "# https://docs.atlas.mongodb.com/tutorial/manage-organizations",
      "# https://docs.atlas.mongodb.com/tutorial/manage-programmatic-access",
      "#",
      "# Terraform MongoDB Atlas Provider Documentation",
      "# https://www.terraform.io/docs/providers/mongodbatlas/index.html",
      "# Terraform 0.12+, MongoDB Atlas Provider 0.4.2+",
      "",
      "#",
      "#  Local Variables",
      "#  You may want to put these in a variables.tf file",
      "#  Do not check a file containing these variables in a public repository",
      "",
      "locals {",
      "  # Replace ORG_ID, PUBLIC_KEY and PRIVATE_KEY with your Atlas variables",
      "  mongodb_atlas_api_pub_key = \"PUBLIC_KEY\"",
      "  mongodb_atlas_api_pri_key = \"PRIVATE_KEY\"",
      "  mongodb_atlas_org_id  = \"ORG_ID\"",
      "",
      "  # Replace USERNAME And PASSWORD with what you want for your database user",
      "  # https://docs.atlas.mongodb.com/tutorial/create-mongodb-user-for-cluster/",
      "  mongodb_atlas_database_username = \"USERNAME\"",
      "  mongodb_atlas_database_user_password = \"PASSWORD\"",
      "",
      "  # Replace IP_ADDRESS with the IP Address from where your application will connect",
      "  # https://docs.atlas.mongodb.com/tutorial/whitelist-connection-ip-address/",
      "  mongodb_atlas_whitelistip = \"IP_ADDRESS\"",
      "}",
=======
    "description": "Bootstraps Atlas configuration for Terraform",
    "body": [
      "#",
      "# Creates an Atlas Cluster using the MongoDB Atlas Terraform Provider",
      "# https://github.com/terraform-providers/terraform-provider-mongodbatlas",
      "# Docs: https://www.terraform.io/docs/providers/mongodbatlas/index.html",
      "#",
      "#  Variables we need for this terraform run",
      "#  Normally want to put them in their own variables.tf file or use Env variables",
      "#",
      "",
      "variable \"mongodb_atlas_api_pub_key\" { default = \"\"}",
      "variable \"mongodb_atlas_api_pri_key\" { default = \"\" }",
      "",
      "variable \"mongodb_atlas_org_id\" { default = \"\"}",
      "",
      "variable \"database_username\" { default = \"\" }",
      "variable \"database_user_password\" { default = \"\" }",
      "",
      "variable \"mongodb_atlas_whitelistip\" { default = \"\" }",
>>>>>>> 7e9820be9cc89f4e913ab64141cf34e0d6b9e62d
      "",
      "#",
      "# Configure the MongoDB Atlas Provider",
      "#",
      "provider \"mongodbatlas\" {",
<<<<<<< HEAD
      "  public_key  = local.mongodb_atlas_api_pub_key",
      "  private_key = local.mongodb_atlas_api_pri_key",
      "}",
      "",
      "#",
      "# Create a Project",
      "#",
      "resource \"mongodbatlas_project\" \"my_project\" {",
      "  name   = \"${1:atlasProjectName}\"",
      "  org_id = local.mongodb_atlas_org_id",
      "}",
      "",
      "#",
      "# Create a Shared Tier Cluster",
      "#",
      "resource \"mongodbatlas_cluster\" \"my_cluster\" {",
      "  project_id              = mongodbatlas_project.my_project.id",
      "  name                    = \"${2:atlasClusterName}\"",
      "",
      "  # Provider Settings \"block\"",
      "  provider_name = \"TENANT\"",
      "",
      "  # options: AWS AZURE GCP",
      "  backing_provider_name = \"${3|AWS,AZURE,GCP|}\"",
      "",
      "  # options: M2/M5 atlas regions per cloud provider",
      "  # GCP - CENTRAL_US SOUTH_AMERICA_EAST_1 WESTERN_EUROPE EASTERN_ASIA_PACIFIC NORTHEASTERN_ASIA_PACIFIC ASIA_SOUTH_1",
      "  # AZURE - US_EAST_2 US_WEST CANADA_CENTRAL EUROPE_NORTH",
      "  # AWS - US_EAST_1 US_WEST_2 EU_WEST_1 EU_CENTRAL_1 AP_SOUTH_1 AP_SOUTHEAST_1 AP_SOUTHEAST_2",
      "  provider_region_name = \"US_EAST_1\"",
      "",
      "  # options: M2 M5",
      "  provider_instance_size_name = \"M${4|2,5|}\"",
      "",
      "  # If select M2 must be 2, if M5 must be 5",
      "  disk_size_gb                = \"${4}\"",
      "",
      "  # Will not change till new version of MongoDB but must be included",
      "  mongo_db_major_version = \"4.2\"",
      "  auto_scaling_disk_gb_enabled = \"false\"",
      "}",
      "",
      "#",
      "# Create an Atlas Admin Database User",
      "#",
      "resource \"mongodbatlas_database_user\" \"my_user\" {",
      "  username           = local.mongodb_atlas_database_username",
      "  password           = local.mongodb_atlas_database_user_password",
      "  project_id         = mongodbatlas_project.my_project.id",
      "  auth_database_name = \"admin\"",
      "",
      "  roles {",
      "    role_name     = \"atlasAdmin\"",
      "    database_name = \"admin\"",
=======
      "  public_key   = \"${var.mongodb_atlas_api_pub_key}\"",
      "  private_key  = \"${var.mongodb_atlas_api_pri_key}\"",
      "}",
      "",
      "#",
      "# Create a Project ",
      "#",
      "resource \"mongodbatlas_project\" \"my_project\" {",
      "  name   = \"${1:atlasProjectName}\"",
      "  org_id = \"${var.mongodb_atlas_org_id}\"",
      "}",
      "",
      "#",
      "# Create a Cluster in 2 Regions",
      "#",
      "resource \"mongodbatlas_cluster\" \"cluster\" {",
      "  name                         = \"${2:atlasClusterName}\"",
      "  project_id                   = \"${mongodbatlas_project.my_project.id}\"",
      "  backup_enabled               = ${3|true,false|}",
      "  auto_scaling_disk_gb_enabled = ${4|true,false|}",
      "  mongo_db_major_version       = \"${5|3.6,4.0,4.2|}\"",
      "  cluster_type                 = \"${6|REPLICASET,SHARDED,GEOSHARDED|}\"",
      "",
      "  provider_name                = \"${7|AWS,GCP,AZURE,TENANT|}\"",
      "  disk_size_gb                 = ${8:diskSizeinGB}",
      "  provider_disk_iops           = ${9:diskSizeinGB}",
      "",
      "  # Instance size may depend on the provider. See docs here: https://docs.atlas.mongodb.com/reference/free-shared-limitations/",
      "  provider_instance_size_name  = \"${10|M2,M5,M10,M20,M30,M40,M50|}\"",
      "  provider_backup_enabled      = ${11|true,false|}",
      "",
      "  replication_specs {",
      "    num_shards                 = ${12:howManyShards}",
      "    regions_config {",
      "      # Region name depends on the provider:",
      "      # - AWS: https://docs.atlas.mongodb.com/reference/amazon-aws/#synopsis",
      "      # - GCP: https://docs.atlas.mongodb.com/reference/google-gcp/#synopsis",
      "      # - AZURE: https://docs.atlas.mongodb.com/reference/microsoft-azure/#synopsis",
      "      region_name              = \"${13:regionName}\"",
      "      priority                 = ${14:priority}",
      "      read_only_nodes          = ${15:howManyReadOnlyNodes}",
      "      analytics_nodes          = ${16:howManyAnalyticsNodes}",
      "      electable_nodes          = ${17:howElectableNodes}",
      "    }",
      "    regions_config {",
      "      # Region name depends on the provider:",
      "      # - AWS: https://docs.atlas.mongodb.com/reference/amazon-aws/#synopsis",
      "      # - GCP: https://docs.atlas.mongodb.com/reference/google-gcp/#synopsis",
      "      # - AZURE: https://docs.atlas.mongodb.com/reference/microsoft-azure/#synopsis",
      "      region_name              = \"${18:regionName}\"",
      "      priority                 = ${19:priority}",
      "      read_only_nodes          = ${20:howManyReadOnlyNodes}",
      "      analytics_nodes          = ${21:howManyAnalyticsNodes}",
      "      electable_nodes          = ${22:howElectableNodes}",
      "    }",
      "  }",
      "}",
      "",
      "#",
      "# Create a Database User",
      "#",
      "resource \"mongodbatlas_database_user\" \"test\" {",
      "  username         = \"${var.database_username}\"",
      "  password         = \"${var.database_user_password}\"",
      "  project_id       = \"${mongodbatlas_project.my_project.id}\"",
      "  database_name    = \"admin\"",
      "",
      "  roles {",
      "    role_name      = \"readWriteAnyDatabase\"",
      "    database_name  = \"admin\"",
>>>>>>> 7e9820be9cc89f4e913ab64141cf34e0d6b9e62d
      "  }",
      "}",
      "",
      "#",
      "# Create an IP Whitelist",
      "#",
<<<<<<< HEAD
      "# can also take a CIDR block or AWS Security Group -",
      "# replace ip_address with either cidr_block = \"CIDR_NOTATION\"",
      "# or aws_security_group = \"SECURITY_GROUP_ID\"",
      "#",
      "resource \"mongodbatlas_project_ip_whitelist\" \"my_ipaddress\" {",
      "      project_id = mongodbatlas_project.my_project.id",
      "      ip_address = local.mongodb_atlas_whitelistip",
      "      comment    = \"My IP Address\"",
      "}"
    ],
    "description": "Bootstraps Atlas configuration for Terraform"
=======
      "resource \"mongodbatlas_project_ip_whitelist\" \"test\" {",
      "  project_id            = \"${mongodbatlas_project.my_project.id}\"  ",
      "  whitelist {  ",
      "    ip_address          = \"${var.mongodb_atlas_whitelistip}\"",
      "    comment             = \"Added with Terraform\"",
      "  }",
      "}"
    ]
>>>>>>> 7e9820be9cc89f4e913ab64141cf34e0d6b9e62d
  }
}
